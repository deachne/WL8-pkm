# Performance Visualizer API

This document details the API for building Performance Visualizer Extensions for Wealth-Lab 8. A Performance Visualizer occupies a tab in the Backtest Results section of the Strategy window, and lets you present the results of a backtest in a particular way.

## Build Environment

You can create a Performance Visualizer in a .NET development tool such as Visual Studio 2022. Create a class library project that targets .NET8, then reference the WealthLab.WPF library DLL that you'll find in the WL8 installation folder.

> **Note:** If you are using Visual Studio 2022, it will need to be updated to at least version 17.8.6 to use .NET8.

Your Performance Visualizer will be a class in this library that descends from `VisualizerBase`, which is defined in the WealthLab.WPF library, in the `WealthLab.WPF` namespace. After you implement and build your library, simply copy the resulting assembly DLL into the WL8 installation folder. The next time WL8 starts up, it will discover your Performance Visualizer, making it available in appropriate locations of the WL8 user interface.

## ResultViewerBase

`VisualizerBase` is derived from the `ResultViewerBase` base class, defined in WealthLab.WPF. `ResultViewerBase` is derived from the WPF `UserControl`. `ResultViewerBase` contains additional members useful for developing Visualizers, particularly:

- `ViewerName` property - Controls text in Visualizer's tab
- `GlyphResource` property - Controls image in Visualizer's tab

## Creating the Files in Visual Studio

1. Create a new UserControl in Visual Studio (generates boilerplate XAML and CS)
2. Modify CS file:
   - Change class to derive from `VisualizerBase`
   - Add `WealthLab.WPF` to using clause
3. Modify XAML file:
   - Add XMLNS reference to WealthLab.WPF library
   - Change base class from UserControl to VisualizerBase

Example XAML structure:
```xaml
<wl:VisualizerBase x:Class="YourNamespace.YourVisualizer"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wl="clr-namespace:WealthLab.WPF;assembly=WealthLab.WPF">
    <!-- Your XAML content here -->
</wl:VisualizerBase>
```

## Accessing the Host (WL8) Environment

The `IHost` interface allows your extension to access information about the user's WealthLab environment. For example, the location of the user data folder, or obtaining a list of DataSets defined by the user. At any point in your extension's code base, you can access an instance of the `IHost` interface using the singleton class `WLHost` and its `Instance` property. Example:

```csharp
//get user data folder
string folder = WLHost.Instance.DataFolder;
```

## Visualizers for Specific Strategy Types

### public virtual bool AllowForStrategyType(StrategyTypes st)
Override to specify supported Strategy types. Your Visualizer won't appear for unsupported types.

Available `StrategyTypes` enum values:
- `Code`
- `BuildingBlock`
- `Rotation`
- `Compiled`
- `MetaStrategy`
- `TradeHistory`

## Visualizing Backtest Results

### public virtual void Initialize()
Override to implement one-time initialization for your Visualizer.

### public virtual void Populate(Backtester backtester, Backtester backtesterBenchmark)
Override to implement backtest visualization. Parameters:
- `backtester`: Contains Strategy backtest results
- `backtesterBenchmark`: Contains benchmark buy & hold results

> **Note:** Consult the Backtester class reference for available properties, especially the `Metrics` property exposing performance metrics generated by WL8 ScoreCards.

### public Backtester Backtester
Returns the Backtester instance containing Strategy performance results.

### public Backtester BacktesterBenchmark
Returns the Backtester instance containing benchmark buy & hold results.

## Interacting with the Strategy Window

### public IStrategyHost ParentStrategyWindow
Returns `IStrategyHost` interface for interacting with the hosting Strategy window. Use this to:
- Access Strategy window properties and methods
- Trigger actions like charting specific symbols 